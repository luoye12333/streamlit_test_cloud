# 批量文件时间戳修改工具使用说明

## 概述

这是一个基于Python和Tkinter开发的批量文件时间戳修改工具，可以批量修改指定文件夹中所有文件的创建时间、修改时间和访问时间。

## 功能特色

### 核心功能
- **批量时间修改**：支持同时修改文件的创建时间、修改时间和访问时间
- **文件过滤**：支持按文件类型过滤（如 *.txt, *.jpg, *.pdf 等）
- **递归扫描**：可选择是否包含子文件夹中的文件
- **隐藏文件处理**：可选择是否包含隐藏文件
- **实时进度显示**：显示处理进度和实时状态
- **日志导出**：支持导出详细的处理日志

### 界面特色
- **直观的图形界面**：基于Tkinter的现代化界面设计
- **文件列表视图**：以表格形式显示所有扫描到的文件及其信息
- **实时状态更新**：处理过程中实时更新每个文件的处理状态
- **进度条显示**：可视化显示整体处理进度

## 系统要求

### 必需依赖
- **Python 3.6+**
- **pywin32** (`pip install pywin32`)
- **tkinter** (通常随Python一起安装)

### 运行环境
- **Windows 操作系统**（使用Windows API修改创建时间）
- **管理员权限**（推荐，某些文件可能需要管理员权限才能修改）

## 安装和运行

### 1. 安装依赖
```bash
pip install pywin32
```

### 2. 运行程序
```bash
python 批量修改文件信息.py
```

或者直接双击运行文件。

## 使用教程

### 1. 选择文件夹
- 点击"选择文件夹"按钮
- 在弹出的对话框中选择要处理的文件夹
- 文件夹路径将显示在输入框中

### 2. 配置处理选项
#### 文件过滤设置
- **文件类型过滤**：选择要处理的文件类型
  - `*.*`：所有文件
  - `*.txt`：只处理文本文件
  - `*.jpg`：只处理JPEG图片
  - 自定义：可手动输入其他类型
- **包含子文件夹**：勾选后会递归处理所有子文件夹
- **包含隐藏文件**：勾选后会处理隐藏文件

#### 时间设置
- **创建时间**：设置文件的创建时间
- **修改时间**：设置文件的修改时间  
- **访问时间**：设置文件的访问时间
- 每个时间类型都有对应的复选框，只有勾选的时间类型才会被修改
- 点击"当前时间"按钮可快速设置为当前系统时间

### 3. 扫描文件
- 点击"扫描文件"按钮
- 程序会根据设置的条件扫描文件夹
- 扫描结果会显示在文件列表中
- 统计信息会显示找到的文件总数

### 4. 开始批量修改
- 确认时间设置正确
- 确认要修改的时间类型已勾选
- 点击"开始批量修改"按钮
- 在确认对话框中确认操作
- 程序开始批量处理文件

### 5. 监控处理进度
- 进度条显示整体处理进度
- 文件列表中每个文件的状态会实时更新：
  - **待处理**：尚未开始处理
  - **处理中...**：正在处理
  - **成功**：处理成功
  - **失败**：处理失败
  - **错误: xxx**：处理出错，显示错误信息

### 6. 停止和重置
- **停止处理**：可随时停止正在进行的批量处理
- **清空列表**：清空当前的文件列表
- **导出日志**：将处理结果导出为文本文件

## 时间格式说明

**标准格式**：`YYYY-MM-DD HH:MM:SS`

**示例**：
- `2025-01-22 14:30:00`
- `2024-12-25 09:15:30`
- `2023-06-01 18:45:00`

## 注意事项

### 重要提醒
1. **备份重要文件**：修改文件时间戳前建议备份重要文件
2. **管理员权限**：某些系统文件或受保护的文件可能需要管理员权限
3. **文件占用**：正在被其他程序使用的文件可能无法修改
4. **网络文件**：网络驱动器上的文件修改可能受到限制

### 兼容性说明
- **Windows专用**：本工具使用Windows API修改创建时间，仅支持Windows系统
- **文件系统**：建议在NTFS文件系统上使用，FAT32等文件系统可能有限制
- **Python版本**：推荐使用Python 3.7或更高版本

### 常见问题处理
1. **权限不足**：以管理员身份运行程序
2. **文件被占用**：关闭正在使用该文件的程序
3. **网络路径问题**：尽量使用本地路径，避免网络驱动器
4. **大量文件处理**：处理大量文件时可能需要较长时间，请耐心等待

## 日志功能

### 日志内容
导出的日志文件包含以下信息：
- 处理时间和文件夹信息
- 处理选项配置
- 时间设置详情
- 处理结果统计
- 失败文件列表
- 所有文件的处理状态

### 日志用途
- **问题排查**：通过日志文件分析处理失败的原因
- **操作记录**：保留批量操作的完整记录
- **审计追踪**：记录文件修改的详细信息

## 技术实现

### 核心技术
- **GUI框架**：Tkinter
- **Windows API**：win32file, win32con, win32api
- **多线程处理**：避免界面卡死
- **文件系统操作**：os, pathlib

### 设计特点
- **用户友好**：直观的图形界面和操作流程
- **健壮性**：完善的错误处理和异常捕获
- **可扩展性**：模块化设计便于功能扩展
- **性能优化**：多线程处理和进度显示

## 版本信息

- **版本**：1.0
- **发布日期**：2025-01-22
- **开发语言**：Python 3.x
- **许可证**：开源免费使用

## 联系和支持

如有问题或建议，请通过以下方式联系：
- 查看代码注释了解实现细节
- 根据错误信息排查问题
- 确保系统满足运行要求

---

**免责声明**：使用本工具修改文件时间戳时，请确保有相应的权限和需求。开发者不对因使用本工具造成的任何损失负责。建议在使用前备份重要文件。